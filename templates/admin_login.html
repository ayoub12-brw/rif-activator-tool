{% extends 'base.html' %}

{% block title %}Admin Login - RIF ACTIVATOR{% endblock %}

{% block content %}
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-md-6 col-lg-4">
      <div class="card card-dark p-4">
        <h4 class="mb-3">Admin Login</h4>
        <p class="muted small">Sign in with your admin password to manage the site.</p>
        <div class="mb-3">
          <label class="form-label">Password</label>
          <input id="adminPass" type="password" class="form-control" placeholder="Admin password">
        </div>
        <div class="d-flex gap-2">
          <button id="loginBtn" class="btn btn-primary">Sign in</button>
          <a href="/" class="btn btn-outline-light">Back</a>
        </div>
        <div id="loginMsg" class="mt-3"></div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('loginBtn').addEventListener('click', async function(){
  const pass = document.getElementById('adminPass').value || '';
  const res = await fetch('/login', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ password: pass })
  });
  if(res.status === 200){
    // success
    location.href = '/admin';
    return;
  }
  if(res.status === 401){
    document.getElementById('loginMsg').innerHTML = '<div class="alert alert-danger mt-2 p-2">Invalid password</div>';
    return;
  }
  const j = await res.json().catch(()=>({}));
  document.getElementById('loginMsg').innerHTML = `<div class="alert alert-warning mt-2 p-2">${j.message || 'Login failed'}</div>`;
});
</script>
{% endblock %}
